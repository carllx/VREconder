# VR Video Processing Pipeline - 规则系统说明

## 📋 概述

本项目采用基于[Cursor Rules最佳实践](https://docs.cursor.com/context/rules)的模块化规则系统，为VR视频处理流水线项目提供全面的开发指导。

## 🏗️ 规则系统架构

### 目录结构
```
.cursor/rules/
├── rules.mdc                    # 主规则文件
├── project-overview.mdc         # 项目概览和核心目标
├── architecture.mdc             # 架构设计规范
├── python-coding.mdc            # Python代码规范
├── powershell-coding.mdc        # PowerShell代码规范
├── bash-coding.mdc              # Bash代码规范
├── video-processing.mdc         # 视频处理特定规范
├── testing.mdc                  # 测试规范
└── refactoring.mdc              # 重构指导规范
```

### 规则分类

#### 1. 全局规则
- **`rules.mdc`**: 主规则文件，定义规则系统架构和应用策略
- **`project-overview.mdc`**: 项目基本信息和核心目标
- **`architecture.mdc`**: 项目架构设计和模块组织

#### 2. 语言特定规则
- **`python-coding.mdc`**: Python代码规范和最佳实践
- **`powershell-coding.mdc`**: PowerShell脚本开发规范
- **`bash-coding.mdc`**: Bash脚本开发规范

#### 3. 领域特定规则
- **`video-processing.mdc`**: 视频处理特定规范和算法
- **`testing.mdc`**: 测试策略和规范
- **`refactoring.mdc`**: 重构指导和最佳实践

## 🎯 规则设计原则

### 1. 模块化设计
- 每个规则文件专注于特定领域
- 避免规则重复和冲突
- 支持规则的独立更新和维护

### 2. 渐进式应用
- 根据文件类型自动应用相应规则
- 支持规则的组合使用
- 提供清晰的规则优先级

### 3. 实用性导向
- 规则基于实际项目需求
- 提供具体的代码示例
- 包含可操作的指导

### 4. 可维护性
- 规则结构清晰，易于理解
- 支持规则的版本控制
- 提供规则更新机制

## 📖 规则内容详解

### 项目概览规则 (`project-overview.mdc`)
- **目标**: 定义项目基本信息和核心目标
- **内容**: 
  - 项目功能描述
  - 技术栈说明
  - 工作流程定义
  - 重构目标
- **应用范围**: 全局应用

### 架构设计规则 (`architecture.mdc`)
- **目标**: 定义项目架构和模块设计
- **内容**:
  - 目录结构规范
  - 模块设计原则
  - 核心模块职责
  - 配置管理策略
- **应用范围**: 所有架构相关文件

### Python代码规范 (`python-coding.mdc`)
- **目标**: 定义Python代码开发标准
- **内容**:
  - 基本编码规范
  - 类型注解要求
  - 文档字符串规范
  - 错误处理模式
  - 性能优化策略
  - 测试规范
- **应用范围**: `src/**/*.py`, `tests/**/*.py`

### PowerShell代码规范 (`powershell-coding.mdc`)
- **目标**: 定义PowerShell脚本开发标准
- **内容**:
  - 函数定义规范
  - 参数验证方法
  - 错误处理机制
  - 日志记录策略
  - 性能优化技巧
- **应用范围**: `scripts/windows/**/*.ps1`

### Bash代码规范 (`bash-coding.mdc`)
- **目标**: 定义Bash脚本开发标准
- **内容**:
  - 脚本结构规范
  - 错误处理机制
  - 参数验证方法
  - 性能优化策略
  - 配置管理
- **应用范围**: `scripts/macos/**/*.sh`

### 视频处理规范 (`video-processing.mdc`)
- **目标**: 定义视频处理特定规范
- **内容**:
  - 编码器选择策略
  - CRF值计算规则
  - FFmpeg参数优化
  - 视频分类规则
  - 视频分割规则
  - 质量保证机制
  - 性能优化策略
- **应用范围**: 视频处理相关模块

### 测试规范 (`testing.mdc`)
- **目标**: 定义测试策略和规范
- **内容**:
  - 测试策略说明
  - 单元测试规范
  - 集成测试规范
  - 性能测试规范
  - 模拟和存根使用
  - 测试数据管理
- **应用范围**: 所有测试相关文件

### 重构指导规则 (`refactoring.mdc`)
- **目标**: 提供重构指导和最佳实践
- **内容**:
  - 重构原则
  - 重构优先级
  - 重构步骤指南
  - 重构检查清单
  - 重构最佳实践
  - 风险缓解策略
- **应用范围**: 重构过程中的所有文件

## 🚀 使用指南

### 开发工作流程

#### 1. 新功能开发
```bash
# 1. 参考项目概览了解目标
# 查看 .cursor/rules/project-overview.mdc

# 2. 遵循架构设计
# 查看 .cursor/rules/architecture.mdc

# 3. 应用语言特定规则
# Python: .cursor/rules/python-coding.mdc
# PowerShell: .cursor/rules/powershell-coding.mdc
# Bash: .cursor/rules/bash-coding.mdc

# 4. 如果是视频处理功能
# 查看 .cursor/rules/video-processing.mdc

# 5. 编写测试
# 查看 .cursor/rules/testing.mdc
```

#### 2. 重构工作
```bash
# 1. 参考重构指导
# 查看 .cursor/rules/refactoring.mdc

# 2. 遵循分阶段重构原则
# 3. 保持向后兼容性
# 4. 确保测试覆盖
```

#### 3. 代码审查
```bash
# 1. 检查架构设计合理性
# 2. 验证语言规范遵循
# 3. 确认测试覆盖充分
# 4. 检查性能优化
```

### 规则优先级

#### 高优先级 (必须遵循)
- 项目架构设计
- 代码质量和可维护性
- 错误处理和日志记录
- 测试覆盖

#### 中优先级 (建议遵循)
- 性能优化
- 代码风格一致性
- 文档完整性
- 配置管理

#### 低优先级 (可选遵循)
- 高级优化技巧
- 可选的工具集成
- 扩展功能支持

## 🔧 规则维护

### 规则更新流程
1. **识别需求**: 根据项目发展识别规则更新需求
2. **修改规则**: 在相应的 `.mdc` 文件中进行修改
3. **更新引用**: 更新主规则文件中的引用
4. **通知团队**: 通知团队成员规则变更

### 规则验证
- 定期检查规则的有效性
- 收集开发者的反馈
- 根据项目发展调整规则
- 确保规则与项目目标一致

### 版本控制
- 规则文件纳入版本控制
- 记录规则变更历史
- 支持规则的回滚
- 维护规则文档

## 📊 规则效果评估

### 代码质量指标
- **测试覆盖率**: 目标 > 80%
- **代码复杂度**: 降低 30%
- **重复代码**: 消除 > 50%
- **硬编码值**: 消除 > 90%

### 性能指标
- **处理速度**: 提升 > 20%
- **内存使用**: 减少 > 30%
- **错误率**: 降低 > 50%
- **启动时间**: 减少 > 40%

### 可维护性指标
- **模块化程度**: > 90%
- **配置集中管理**: 100%
- **文档完整性**: > 95%
- **代码复用率**: > 70%

## 🎯 总结

新的规则系统为VR视频处理流水线项目提供了：

1. **结构化指导**: 模块化的规则设计，覆盖开发的各个方面
2. **实用性强**: 基于实际项目需求，提供具体的代码示例
3. **易于维护**: 清晰的规则结构，支持独立更新
4. **全面覆盖**: 从架构设计到具体实现，从代码规范到测试策略

通过遵循这些规则，项目将实现：
- 更高的代码质量
- 更好的可维护性
- 更快的开发效率
- 更稳定的系统性能

建议团队成员熟悉规则系统，在开发过程中积极应用这些规则，并根据项目发展不断完善规则内容。 