# VREconder æ¶æ„é‡æ„å®ŒæˆæŠ¥å‘Š

## ğŸ¯ é‡æ„ç›®æ ‡

æœ¬æ¬¡é‡æ„çš„ç›®æ ‡æ˜¯è§£å†³åŸæœ‰æ¶æ„ä¸­å­˜åœ¨çš„èŒè´£æ··ä¹±ã€ä¾èµ–å…³ç³»ä¸æ¸…æ™°ç­‰é—®é¢˜ï¼Œå»ºç«‹æ¸…æ™°çš„ä¸‰å±‚æ¶æ„è®¾è®¡ã€‚

## ğŸ—ï¸ æ–°æ¶æ„è®¾è®¡

### æ¶æ„å±‚æ¬¡

```
ç”¨æˆ·å±‚ (User Layer)
â”œâ”€â”€ scripts/               # å¹³å°ç‰¹å®šè„šæœ¬
â”‚   â”œâ”€â”€ windows/           # Windows PowerShell è„šæœ¬
â”‚   â”œâ”€â”€ macos/             # macOS/Linux Shell è„šæœ¬
â”‚   â””â”€â”€ chrome/            # æµè§ˆå™¨æ‰©å±•è„šæœ¬

å·¥å…·å±‚ (Tools Layer)
â”œâ”€â”€ tools/                 # è·¨å¹³å°ç”¨æˆ·å·¥å…·
â”‚   â”œâ”€â”€ batch/             # æ‰¹é‡å¤„ç†å·¥å…·
â”‚   â”œâ”€â”€ maintenance/       # ç³»ç»Ÿç»´æŠ¤å·¥å…·
â”‚   â””â”€â”€ deployment/        # éƒ¨ç½²é…ç½®å·¥å…·

æ ¸å¿ƒå±‚ (Core Layer)
â”œâ”€â”€ src/                   # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ main.py            # ç»Ÿä¸€å…¥å£ç‚¹
â”‚   â”œâ”€â”€ encoders/          # ç¼–ç å™¨æ¨¡å—
â”‚   â”œâ”€â”€ processors/        # å¤„ç†å™¨æ¨¡å—
â”‚   â”œâ”€â”€ classifiers/       # åˆ†ç±»å™¨æ¨¡å—
â”‚   â”œâ”€â”€ combiners/         # åˆå¹¶å™¨æ¨¡å—
â”‚   â”œâ”€â”€ config/            # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ utils/             # å†…éƒ¨å·¥å…·ï¼ˆä»…ä¾›src/ä½¿ç”¨ï¼‰
```

### ä¾èµ–å…³ç³»

```
scripts/ â†’ tools/ â†’ src/main.py â†’ src/modules
```

## ğŸ“ ç›®å½•ç»“æ„å˜åŒ–

### æ–°å¢ç›®å½•

#### `tools/` - ç”¨æˆ·å‹å¥½å·¥å…·å±‚
```
tools/
â”œâ”€â”€ __init__.py                    # å·¥å…·åŒ…åˆå§‹åŒ–
â”œâ”€â”€ batch/                         # æ‰¹é‡å¤„ç†å·¥å…·å¥—ä»¶
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ batch_processor.py         # æ‰¹é‡å¤„ç†æ ¸å¿ƒé€»è¾‘
â”‚   â””â”€â”€ batch_cli.py               # æ‰¹é‡å¤„ç†å‘½ä»¤è¡Œæ¥å£
â”œâ”€â”€ maintenance/                   # ç³»ç»Ÿç»´æŠ¤å·¥å…·
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ffmpeg_checker.py          # FFmpegç¯å¢ƒæ£€æµ‹
â”‚   â”œâ”€â”€ system_diagnose.py         # ç³»ç»Ÿè¯Šæ–­
â”‚   â””â”€â”€ config_validator.py        # é…ç½®éªŒè¯
â””â”€â”€ deployment/                    # éƒ¨ç½²å·¥å…·
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ install_deps.py            # ä¾èµ–å®‰è£…
    â””â”€â”€ setup_env.py               # ç¯å¢ƒé…ç½®
```

### é‡æ„ç›®å½•

#### `scripts/` - å¹³å°ç‰¹å®šè„šæœ¬é‡æ„
```
scripts/
â”œâ”€â”€ windows/
â”‚   â”œâ”€â”€ batch_encoder.ps1   # æ–°å¢ï¼šè°ƒç”¨tools/batch
â”‚   â””â”€â”€ [å…¶ä»–ç°æœ‰è„šæœ¬ä¿æŒä¸å˜]
â”œâ”€â”€ macos/
â”‚   â”œâ”€â”€ batch_encoder.sh    # æ–°å¢ï¼šè°ƒç”¨tools/batch
â”‚   â””â”€â”€ [å…¶ä»–ç°æœ‰è„šæœ¬ä¿æŒä¸å˜]
â””â”€â”€ chrome/
    â””â”€â”€ [ä¿æŒä¸å˜]
```

### ç§»é™¤æ–‡ä»¶

- `batch_process.py` - å·²è¿ç§»åˆ° `tools/batch/`

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. æ‰¹é‡å¤„ç†å·¥å…· (`tools/batch/`)

#### `BatchProcessor` ç±»
- **èŒè´£**: æä¾›æ‰¹é‡è§†é¢‘å¤„ç†çš„æ ¸å¿ƒé€»è¾‘
- **è®¾è®¡**: è°ƒç”¨ `src/main.py` å®ç°å…·ä½“åŠŸèƒ½ï¼Œä¸é‡å¤å®ç°
- **ç‰¹æ€§**: 
  - å‚æ•°éªŒè¯
  - è¿›åº¦ç›‘æ§
  - é”™è¯¯å¤„ç†
  - ç»“æœç»Ÿè®¡

#### `BatchCLI` ç±»
- **èŒè´£**: æä¾›ç”¨æˆ·å‹å¥½çš„å‘½ä»¤è¡Œæ¥å£
- **ç‰¹æ€§**:
  - å®Œæ•´çš„å‚æ•°è§£æ
  - è¯¦ç»†çš„å¸®åŠ©ä¿¡æ¯
  - æ¨¡æ‹Ÿè¿è¡Œæ¨¡å¼
  - æ–‡ä»¶åˆ—è¡¨é¢„è§ˆ

### 2. ç»´æŠ¤å·¥å…· (`tools/maintenance/`)

#### `FFmpegChecker` ç±»
- **åŸºäº**: `src/utils/ffmpeg_detector.py`
- **å¢å¼º**: ç”¨æˆ·å‹å¥½çš„è¾“å‡ºã€å®‰è£…æŒ‡å¯¼ã€é—®é¢˜è¯Šæ–­

#### `SystemDiagnose` ç±»
- **åŠŸèƒ½**: ç³»ç»Ÿç¯å¢ƒè¯Šæ–­ã€GPUæ£€æµ‹ã€ä¾èµ–æ£€æŸ¥

#### `ConfigValidator` ç±»
- **åŠŸèƒ½**: é…ç½®æ–‡ä»¶éªŒè¯ã€ç¤ºä¾‹é…ç½®ç”Ÿæˆ

### 3. éƒ¨ç½²å·¥å…· (`tools/deployment/`)

#### `DependencyInstaller` ç±»
- **åŠŸèƒ½**: Pythonä¾èµ–è‡ªåŠ¨å®‰è£…å’Œæ£€æŸ¥

#### `EnvironmentSetup` ç±»
- **åŠŸèƒ½**: å®Œæ•´çš„ç¯å¢ƒé…ç½®å’Œå®‰è£…æµ‹è¯•

## ğŸ”„ æ¶æ„ä¼˜åŠ¿

### 1. æ¸…æ™°çš„èŒè´£åˆ†ç¦»

#### ä¹‹å‰çš„é—®é¢˜
```python
# ç”¨æˆ·ç›´æ¥è°ƒç”¨å¤šä¸ªå…¥å£ç‚¹
batch_process.py              # æ ¹ç›®å½•æ‰¹é‡å¤„ç†
src/main.py                   # æ ¸å¿ƒåŠŸèƒ½
src/utils/ffmpeg_detector.py  # å†…éƒ¨å·¥å…·ä½†ç”¨æˆ·å‹å¥½æ€§å·®
```

#### ç°åœ¨çš„è§£å†³æ–¹æ¡ˆ
```python
# æ¸…æ™°çš„è°ƒç”¨å±‚æ¬¡
scripts/windows/batch_encoder.ps1  # Windowsç”¨æˆ·å…¥å£
tools/batch/batch_cli.py                 # è·¨å¹³å°å·¥å…·æ¥å£
src/main.py                              # æ ¸å¿ƒåŠŸèƒ½å®ç°
src/utils/ffmpeg_detector.py             # å†…éƒ¨å·¥å…·
```

### 2. è·¨å¹³å°ä¸€è‡´æ€§

#### ç»Ÿä¸€çš„å·¥å…·æ¥å£
- Windows: `scripts/windows/batch_encoder.ps1`
- macOS/Linux: `scripts/macos/batch_encoder.sh`
- éƒ½è°ƒç”¨: `tools/batch/batch_cli.py`

#### ç»Ÿä¸€çš„å‚æ•°å’ŒåŠŸèƒ½
- æ‰€æœ‰å¹³å°æä¾›ç›¸åŒçš„åŠŸèƒ½
- ç›¸åŒçš„å‚æ•°åç§°å’Œè¡Œä¸º
- ç›¸åŒçš„é”™è¯¯å¤„ç†å’Œè¾“å‡ºæ ¼å¼

### 3. æ˜“äºç»´æŠ¤å’Œæ‰©å±•

#### æ¨¡å—åŒ–è®¾è®¡
- æ¯ä¸ªå·¥å…·éƒ½æ˜¯ç‹¬ç«‹çš„æ¨¡å—
- æ¸…æ™°çš„æ¥å£å®šä¹‰
- å®¹æ˜“æ·»åŠ æ–°åŠŸèƒ½

#### å‘åå…¼å®¹
- `src/main.py` ä¿æŒä¸å˜
- ç°æœ‰æ ¸å¿ƒåŠŸèƒ½å®Œå…¨ä¿ç•™
- å¹³å°è„šæœ¬å¯ä»¥å…±å­˜

## ğŸ“‹ ä½¿ç”¨æŒ‡å—

### 1. æ‰¹é‡å¤„ç†

#### ä½¿ç”¨toolsï¼ˆæ¨èï¼‰
```bash
# è·¨å¹³å°Pythonæ¥å£
python tools/batch/batch_cli.py --input-dir ./videos --output-dir ./output

# æ¨¡æ‹Ÿè¿è¡Œ
python tools/batch/batch_cli.py --input-dir ./videos --output-dir ./output --dry-run

# åˆ—å‡ºæ–‡ä»¶
python tools/batch/batch_cli.py --input-dir ./videos --output-dir ./output --list-files
```

#### ä½¿ç”¨å¹³å°è„šæœ¬
```powershell
# Windows
.\scripts\windows\batch_encoder.ps1 -InputDir ".\videos" -OutputDir ".\output"
```

```bash
# macOS/Linux
./scripts/macos/batch_encoder.sh --input-dir ./videos --output-dir ./output
```

### 2. ç³»ç»Ÿç»´æŠ¤

#### FFmpegæ£€æµ‹
```bash
python tools/maintenance/ffmpeg_checker.py --test --diagnose
```

#### ç³»ç»Ÿè¯Šæ–­
```bash
python tools/maintenance/system_diagnose.py --full
```

#### é…ç½®éªŒè¯
```bash
python tools/maintenance/config_validator.py --create-sample
```

### 3. ç¯å¢ƒéƒ¨ç½²

#### ä¾èµ–å®‰è£…
```bash
python tools/deployment/install_deps.py --install
```

#### ç¯å¢ƒé…ç½®
```bash
python tools/deployment/setup_env.py --setup-all
```

## ğŸ§ª æµ‹è¯•å’ŒéªŒè¯

### éªŒè¯æ¶æ„ä¾èµ–å…³ç³»
```bash
# æµ‹è¯•å·¥å…·æ¨¡å—å¯¼å…¥
python -c "from tools.batch import BatchProcessor; print('âœ“ æ‰¹é‡å¤„ç†å·¥å…·')"
python -c "from tools.maintenance import FFmpegChecker; print('âœ“ ç»´æŠ¤å·¥å…·')"

# æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½
python src/main.py --help

# æµ‹è¯•å¹³å°è„šæœ¬
python tools/batch/batch_cli.py --help
```

### åŠŸèƒ½å®Œæ•´æ€§æµ‹è¯•
```bash
# æ¨¡æ‹Ÿæ‰¹é‡å¤„ç†
python tools/batch/batch_cli.py --input-dir ./test_videos --output-dir ./test_output --dry-run

# ç³»ç»Ÿè¯Šæ–­
python tools/maintenance/system_diagnose.py

# ç¯å¢ƒæ£€æŸ¥
python tools/deployment/setup_env.py --test-only
```

## ğŸ“Š æ¶æ„å¯¹æ¯”

| æ–¹é¢ | é‡æ„å‰ | é‡æ„å |
|------|--------|--------|
| **æ¨¡å—åŒ–** | 6/10 è¾¹ç•Œæ¨¡ç³Š | 9/10 æ¸…æ™°åˆ†å±‚ |
| **èŒè´£åˆ†ç¦»** | 5/10 å­˜åœ¨é‡å  | 9/10 æ˜ç¡®åˆ’åˆ† |
| **ä¾èµ–ç®¡ç†** | 6/10 å…³ç³»å¤æ‚ | 9/10 å•å‘æ¸…æ™° |
| **ç”¨æˆ·ä½“éªŒ** | 6/10 å¤šå…¥å£æ··ä¹± | 9/10 ç»Ÿä¸€å‹å¥½ |
| **å¯ç»´æŠ¤æ€§** | 6/10 è¾¹ç•Œä¸æ¸… | 9/10 æ˜“äºæ‰©å±• |
| **è·¨å¹³å°æ€§** | 7/10 éƒ¨åˆ†æ”¯æŒ | 9/10 å®Œå…¨ä¸€è‡´ |

## ğŸ‰ é‡æ„æˆæœ

### âœ… è§£å†³çš„é—®é¢˜

1. **èŒè´£æ··ä¹±** â†’ æ¸…æ™°çš„ä¸‰å±‚æ¶æ„
2. **ä¾èµ–å¤æ‚** â†’ å•å‘ä¾èµ–é“¾
3. **å…¥å£æ··ä¹±** â†’ ç»Ÿä¸€çš„å·¥å…·æ¥å£
4. **ç»´æŠ¤å›°éš¾** â†’ æ¨¡å—åŒ–è®¾è®¡
5. **è·¨å¹³å°ä¸ä¸€è‡´** â†’ ç»Ÿä¸€çš„åŠŸèƒ½å’Œæ¥å£

### ğŸš€ æ–°å¢èƒ½åŠ›

1. **ç”¨æˆ·å‹å¥½çš„å·¥å…·** - å®Œæ•´çš„CLIå·¥å…·å¥—ä»¶
2. **ç³»ç»Ÿè¯Šæ–­** - è‡ªåŠ¨ç¯å¢ƒæ£€æµ‹å’Œé—®é¢˜è¯Šæ–­
3. **éƒ¨ç½²è‡ªåŠ¨åŒ–** - ä¸€é”®ç¯å¢ƒé…ç½®
4. **é…ç½®éªŒè¯** - é…ç½®æ–‡ä»¶æ­£ç¡®æ€§æ£€æŸ¥
5. **å¹³å°ä¸€è‡´æ€§** - æ‰€æœ‰å¹³å°ç›¸åŒçš„åŠŸèƒ½

### ğŸ“ˆ æ¶æ„ä¼˜åŠ¿

1. **å¯æ‰©å±•æ€§** - å®¹æ˜“æ·»åŠ æ–°å·¥å…·æ¨¡å—
2. **å¯ç»´æŠ¤æ€§** - æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œ
3. **å¯æµ‹è¯•æ€§** - ç‹¬ç«‹çš„æ¨¡å—ä¾¿äºæµ‹è¯•
4. **ç”¨æˆ·å‹å¥½** - ç»Ÿä¸€çš„ä½¿ç”¨ä½“éªŒ
5. **ä¸“ä¸šæ€§** - ä¿æŒæ ¸å¿ƒåŠŸèƒ½çš„ç¨³å®šæ€§

## ğŸ”® æœªæ¥å‘å±•

### çŸ­æœŸè®¡åˆ’
- [ ] å®Œå–„å·¥å…·æ¨¡å—çš„é”™è¯¯å¤„ç†
- [ ] æ·»åŠ æ›´å¤šè¯Šæ–­åŠŸèƒ½
- [ ] ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

### é•¿æœŸè®¡åˆ’
- [ ] GUIå·¥å…·å¼€å‘
- [ ] æ’ä»¶ç³»ç»Ÿ
- [ ] äº‘ç«¯é›†æˆ
- [ ] APIæœåŠ¡åŒ–

---

**é‡æ„å®Œæˆæ—¶é—´**: 2025å¹´12æœˆ8æ—¥  
**æ¶æ„ç‰ˆæœ¬**: v2.0.0  
**å…¼å®¹æ€§**: å‘åå…¼å®¹æ‰€æœ‰ç°æœ‰åŠŸèƒ½ 